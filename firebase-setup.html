<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurar Firebase - Brain Games Storm</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .config-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .step {
            margin: 30px 0;
            padding: 20px;
            border-left: 4px solid #667eea;
            background: #f8f9fa;
            border-radius: 0 8px 8px 0;
        }
        .step h3 {
            color: #667eea;
            margin: 0 0 15px 0;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .warning {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        .highlight {
            background: #ffeb3b;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="config-container">
        <h1 style="color: #667eea; text-align: center; margin-bottom: 30px;">
            üî• Configuraci√≥n Firebase - Brain Games Storm
        </h1>
        
        <div class="step success">
            <h3>üìã ¬øPor qu√© Firebase es GRATIS para siempre?</h3>
            <ul>
                <li><strong>1 GB almacenamiento:</strong> ‚âà 500,000 quizzes</li>
                <li><strong>10 GB transferencia/mes:</strong> ‚âà 50,000 estudiantes</li>
                <li><strong>100 conexiones simult√°neas:</strong> ‚âà 100 estudiantes activos</li>
                <li><strong>‚úÖ SIN L√çMITE DE TIEMPO:</strong> Nunca se vence</li>
            </ul>
        </div>

        <div class="step">
            <h3>1Ô∏è‚É£ Crear Proyecto Firebase</h3>
            <p>Ve a: <a href="https://console.firebase.google.com/" target="_blank" class="btn">üîó Firebase Console</a></p>
            <ol>
                <li>Haz clic en <span class="highlight">"Crear un proyecto"</span></li>
                <li>Nombre del proyecto: <span class="highlight">BrainGamesStorm</span></li>
                <li>Desactiva Google Analytics (opcional)</li>
                <li>Haz clic en <span class="highlight">"Crear proyecto"</span></li>
            </ol>
        </div>

        <div class="step">
            <h3>2Ô∏è‚É£ Configurar Realtime Database</h3>
            <ol>
                <li>En el men√∫ izquierdo: <span class="highlight">"Realtime Database"</span></li>
                <li>Haz clic en <span class="highlight">"Crear base de datos"</span></li>
                <li>Ubicaci√≥n: <span class="highlight">"us-central1"</span></li>
                <li>Reglas: <span class="highlight">"Empezar en modo de prueba"</span></li>
                <li>Haz clic en <span class="highlight">"Habilitar"</span></li>
            </ol>
        </div>

        <div class="step">
            <h3>3Ô∏è‚É£ Obtener Configuraci√≥n Web</h3>
            <ol>
                <li>Ve a <span class="highlight">"Configuraci√≥n del proyecto"</span> (√≠cono engranaje)</li>
                <li>Pesta√±a <span class="highlight">"General"</span></li>
                <li>Secci√≥n <span class="highlight">"Tus aplicaciones"</span> ‚Üí √çcono <span class="highlight">"Web"</span></li>
                <li>Nombre de la app: <span class="highlight">BrainGamesStorm</span></li>
                <li>‚úÖ Marcar <span class="highlight">"Tambi√©n configura Firebase Hosting"</span></li>
                <li>Haz clic en <span class="highlight">"Registrar app"</span></li>
            </ol>
        </div>

        <div class="step warning">
            <h3>4Ô∏è‚É£ COPIAR Configuraci√≥n</h3>
            <p>Ver√°s algo como esto:</p>
            <div class="code-block">
const firebaseConfig = {
  apiKey: "AIzaSyB...",
  authDomain: "braingamesstorm.firebaseapp.com",
  databaseURL: "https://braingamesstorm-default-rtdb.firebaseio.com",
  projectId: "braingamesstorm",
  storageBucket: "braingamesstorm.appspot.com",
  messagingSenderId: "123456789",
  appId: "1:123456789:web:abc123def456"
};
            </div>
            <p><strong>üìã COPIA TODA ESA CONFIGURACI√ìN</strong> y p√©gala aqu√≠ abajo:</p>
            <textarea id="firebaseConfig" placeholder="Pega tu configuraci√≥n de Firebase aqu√≠..." 
                style="width: 100%; height: 150px; padding: 15px; border: 2px solid #667eea; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 14px; resize: vertical;"></textarea>
        </div>

        <div class="step">
            <h3>5Ô∏è‚É£ Configurar Reglas de Seguridad</h3>
            <p>En la consola Firebase, ve a <span class="highlight">Realtime Database ‚Üí Reglas</span> y pega esto:</p>
            <div class="code-block">
{
  "rules": {
    "games": {
      "$gameCode": {
        ".read": true,
        ".write": true,
        ".indexOn": ["createdAt"]
      }
    }
  }
}
            </div>
            <p>Luego haz clic en <span class="highlight">"Publicar"</span></p>
        </div>

        <div style="text-align: center; margin: 40px 0;">
            <button class="btn" onclick="generateFirebaseCode()" style="font-size: 18px; padding: 15px 30px;">
                üöÄ Generar C√≥digo para Brain Games Storm
            </button>
        </div>

        <div id="generatedCode" style="display: none;">
            <div class="step success">
                <h3>‚úÖ ¬°C√≥digo Generado!</h3>
                <p>Copia este c√≥digo y ejecuta los comandos que aparecer√°n abajo:</p>
                <div class="code-block" id="codeOutput"></div>
                <button class="btn" onclick="copyCode()">üìã Copiar C√≥digo</button>
                <button class="btn" onclick="applyFirebaseConfig()">üîß Aplicar Configuraci√≥n Autom√°ticamente</button>
            </div>
        </div>

        <div class="step">
            <h3>üí° Trucos para Ahorrar Datos</h3>
            <ul>
                <li><strong>Auto-limpieza:</strong> Los juegos se eliminan autom√°ticamente despu√©s de 24 horas</li>
                <li><strong>Compresi√≥n:</strong> Solo se env√≠an datos esenciales</li>
                <li><strong>Cach√© local:</strong> Reduce consultas innecesarias</li>
                <li><strong>M√∫ltiples proyectos:</strong> Si necesitas m√°s, crea otro proyecto</li>
            </ul>
        </div>
    </div>

    <script>
        function generateFirebaseCode() {
            const configText = document.getElementById('firebaseConfig').value.trim();
            
            if (!configText) {
                alert('Por favor, pega la configuraci√≥n de Firebase primero');
                return;
            }
            
            // Extraer la configuraci√≥n
            let config;
            try {
                // Intentar extraer la configuraci√≥n del texto pegado
                const match = configText.match(/const firebaseConfig = ({[\s\S]*?});/);
                if (match) {
                    config = eval('(' + match[1] + ')');
                } else {
                    // Intentar como JSON directo
                    config = JSON.parse(configText);
                }
            } catch (error) {
                alert('Error al parsear la configuraci√≥n. Aseg√∫rate de copiar correctamente el objeto firebaseConfig.');
                return;
            }
            
            // Generar el c√≥digo
            const generatedCode = `
// Configuraci√≥n Firebase generada autom√°ticamente
const firebaseConfig = ${JSON.stringify(config, null, 2)};

// Aplicar configuraci√≥n
window.firebaseConfigGenerated = firebaseConfig;
console.log('‚úÖ Configuraci√≥n Firebase cargada:', firebaseConfig);
            `;
            
            document.getElementById('codeOutput').textContent = generatedCode;
            document.getElementById('generatedCode').style.display = 'block';
            
            // Guardar en localStorage para uso posterior
            localStorage.setItem('firebaseConfig', JSON.stringify(config));
        }
        
        function copyCode() {
            const code = document.getElementById('codeOutput').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úÖ C√≥digo copiado al portapapeles');
            });
        }
        
        function applyFirebaseConfig() {
            const configText = document.getElementById('firebaseConfig').value.trim();
            
            if (!configText) {
                alert('Por favor, pega la configuraci√≥n de Firebase primero');
                return;
            }
            
            // Mostrar instrucciones
            alert('üöÄ Configuraci√≥n lista!\n\n1. Te voy a aplicar la configuraci√≥n autom√°ticamente\n2. Recarga la p√°gina despu√©s\n3. ¬°Tu sistema estar√° listo!');
            
            // Comunicar con la ventana padre si est√° en iframe, o redirigir
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'firebase-config',
                    config: JSON.parse(document.getElementById('firebaseConfig').value)
                }, '*');
            } else {
                // Aplicar directamente
                window.location.href = 'admin.html?firebase-setup=true';
            }
        }
    </script>
</body>
</html>